!function($){$.fn.slider=function(options,flag){var EVENT=window.navigator.msPointerEnabled?2:"ontouchend"in document?3:1;function call(f,scope,args){"function"==typeof f&&f.call(scope,args)}window.debug&&console&&console.log(EVENT);var percentage={to:function(range,value){return 100*(value=range[0]<0?value+Math.abs(range[0]):value-range[0])/this._length(range)},from:function(range,value){return 100*value/this._length(range)},is:function(range,value){return value*this._length(range)/100+range[0]},_length:function(range){return range[0]>range[1]?range[0]-range[1]:range[1]-range[0]}};function correct(proposal,slider,handle){var other,setup=slider.data("setup"),handles=setup.handles,settings=setup.settings,pos=setup.pos;(proposal=proposal<0?0:100<proposal?100:proposal,2==settings.handles)&&(proposal=handle.is(":first-child")?(other=parseFloat(handles[1][0].style[pos])-settings.margin)<proposal?other:proposal:proposal<(other=parseFloat(handles[0][0].style[pos])+settings.margin)?other:proposal);if(settings.step){var per=percentage.from(settings.range,settings.step);proposal=Math.round(proposal/per)*per}return proposal}function client(f){try{return[f.clientX||f.originalEvent.clientX||f.originalEvent.touches[0].clientX,f.clientY||f.originalEvent.clientY||f.originalEvent.touches[0].clientY]}catch(e){return["x","y"]}}function place(handle,pos){return parseFloat(handle[0].style[pos])}var defaults={handles:1,serialization:{to:["",""],resolution:.01}};methods={create:function(){return this.each(function(){var pos,orientation,settings=$.extend(defaults,options),slider=$(this).data("_isnS_",!0),handles=[],classes="",num=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},split=(settings.serialization.resolution=settings.serialization.resolution||.01).toString().split("."),res=1==split[0]?0:split[1].length;settings.start=num(settings.start)?[settings.start,0]:settings.start,$.each(settings,function(a,b){num(b)?settings[a]=parseFloat(b):"object"==typeof b&&num(b[0])&&(b[0]=parseFloat(b[0]),num(b[1])&&(b[1]=parseFloat(b[1])));var e=!1;switch(b=void 0===b?"x":b,a){case"range":case"start":e=2!=b.length||!num(b[0])||!num(b[1]);break;case"handles":e=b<1||2<b||!num(b);break;case"connect":e="lower"!=b&&"upper"!=b&&"boolean"!=typeof b;break;case"orientation":e="vertical"!=b&&"horizontal"!=b;break;case"margin":case"step":e=void 0!==b&&!num(b);break;case"serialization":e="object"!=typeof b||!num(b.resolution)||"object"==typeof b.to&&b.to.length<settings.handles;break;case"slide":e="function"!=typeof b}e&&console&&console.error("Bad input for "+a+" on slider:",slider)}),settings.margin=settings.margin?percentage.from(settings.range,settings.margin):0,(settings.serialization.to instanceof jQuery||"string"==typeof settings.serialization.to||!1===settings.serialization.to)&&(settings.serialization.to=[settings.serialization.to]),"vertical"==settings.orientation?(classes+="vertical",pos="top",orientation=1):(classes+="horizontal",pos="left",orientation=0),classes+=settings.connect?"lower"==settings.connect?" connect lower":" connect":"",slider.addClass(classes);for(var i=0;i<settings.handles;i++){handles[i]=slider.append("<a><div></div></a>").children(":last");var setTo=percentage.to(settings.range,settings.start[i]);handles[i].css(pos,setTo+"%"),100==setTo&&handles[i].is(":first-child")&&handles[i].css("z-index",2);var bind=".slider",onEvent=(1===EVENT?"mousedown":2===EVENT?"MSPointerDown":"touchstart")+bind+"X",moveEvent=(1===EVENT?"mousemove":2===EVENT?"MSPointerMove":"touchmove")+bind,offEvent=(1===EVENT?"mouseup":2===EVENT?"MSPointerUp":"touchend")+bind;handles[i].find("div").on(onEvent,function(e){if($("body").bind("selectstart"+bind,function(){return!1}),!slider.hasClass("disabled")){$("body").addClass("TOUCH");var handle=$(this).addClass("active").parent(),unbind=handle.add($(document)).add("body"),originalPosition=parseFloat(handle[0].style[pos]),originalClick=client(e),previousClick=originalClick,previousProposal=!1;$(document).on(moveEvent,function(f){f.preventDefault();var currentClick=client(f);if("x"!=currentClick[0]){currentClick[0]-=originalClick[0],currentClick[1]-=originalClick[1];var movement=[previousClick[0]!=currentClick[0],previousClick[1]!=currentClick[1]],proposal=originalPosition+100*currentClick[orientation]/(orientation?slider.height():slider.width());proposal=correct(proposal,slider,handle),movement[orientation]&&proposal!=previousProposal&&(handle.css(pos,proposal+"%").data("input").val(percentage.is(settings.range,proposal).toFixed(res)),call(settings.slide,slider.data("_n",!0)),previousProposal=proposal,handle.css("z-index",2==handles.length&&100==proposal&&handle.is(":first-child")?2:1)),previousClick=currentClick}}).on(offEvent,function(){unbind.off(bind),$("body").removeClass("TOUCH"),slider.find(".active").removeClass("active").end().data("_n")&&slider.data("_n",!1).change()})}}).on("click",function(e){e.stopPropagation()})}1==EVENT&&slider.on("click",function(f){if(!slider.hasClass("disabled")){var currentClick=client(f),proposal=100*(currentClick[orientation]-slider.offset()[pos])/(orientation?slider.height():slider.width()),handle=1<handles.length?currentClick[orientation]<(handles[0].offset()[pos]+handles[1].offset()[pos])/2?handles[0]:handles[1]:handles[0];!function(handle,to,slider){handle.css(pos,to+"%").data("input").val(percentage.is(settings.range,to).toFixed(res))}(handle,correct(proposal,slider,handle)),call(settings.slide,slider),slider.change()}});for(i=0;i<handles.length;i++){var val=percentage.is(settings.range,place(handles[i],pos)).toFixed(res);"string"==typeof settings.serialization.to[i]?handles[i].data("input",slider.append('<input type="hidden" name="'+settings.serialization.to[i]+'">').find("input:last").val(val).change(function(a){a.stopPropagation()})):0==settings.serialization.to[i]?handles[i].data("input",{val:function(a){if(void 0===a)return this.handle.data("noUiVal");this.handle.data("noUiVal",a)},handle:handles[i]}):handles[i].data("input",settings.serialization.to[i].data("handleNR",i).val(val).change(function(){var arr=[null,null];arr[$(this).data("handleNR")]=$(this).val(),slider.val(arr)}))}$(this).data("setup",{settings:settings,handles:handles,pos:pos,res:res})})},val:function(){if(void 0!==arguments[0]){var val="number"==typeof arguments[0]?[arguments[0]]:arguments[0];return this.each(function(){for(var setup=$(this).data("setup"),i=0;i<setup.handles.length;i++)if(null!=val[i]){var proposal=correct(percentage.to(setup.settings.range,val[i]),$(this),setup.handles[i]);setup.handles[i].css(setup.pos,proposal+"%").data("input").val(percentage.is(setup.settings.range,proposal).toFixed(setup.res))}})}for(var handles=$(this).data("setup").handles,re=[],i=0;i<handles.length;i++)re.push(parseFloat(handles[i].data("input").val()));return 1==re.length?re[0]:re},disabled:function(){return flag?$(this).addClass("disabled"):$(this).removeClass("disabled")}};var $_val=jQuery.fn.val;return jQuery.fn.val=function(){return this.data("_isnS_")?methods.val.apply(this,arguments):$_val.apply(this,arguments)},"disabled"==options?methods.disabled.apply(this):methods.create.apply(this)}}(jQuery),function($){$.fn.videoPlayer=function(extras){var playerGUI="#"+$(this).attr("id"),playerID="#"+$(this).find(".videoPlayer").attr("id");try{var settings=JSON.parse($(this).find(".playerData").text())}catch(err){console.log("JSON parse ERROR, fall back to JS!");settings=extras}$(this).find(".playerData").remove(),$(this).append('<div class="playerScreen">\t\t\t<a tabindex="0" href="#" class="video-play noload"></a>\t\t\t</div>\t\t\t<div class="controls">\t\t\t<div class="left-block">\t\t\t<a tabindex="0" href="#" class="play smooth noload govuk-link" title="Play"></a>\t\t\t<a tabindex="0" href="#" class="pause smooth noload govuk-link" title="Pause"></a>\t\t\t</div>\t\t\t<div class="play-progress">\t\t\t<span>'+settings.name+'</span>\t\t\t<div class="progressBar">\t\t\t<div class="seekBar">\t\t\t<div class="playBar"></div>\t\t\t</div>\t\t\t</div>\t\t\t<div class="time current">00:00</div>\t\t\t<div class="time duration">00:00</div>\t\t\t</div>\t\t\t<div class="right-block">\t\t\t<div class="volumeBar">\t\t\t<div class="currentVolume"><div class="curvol"></div></div>\t\t\t</div>\t\t\t<div class="volumeText">Volume: 50</div>\t\t\t<a href="#" tabindex="0" class="fullScreen smooth noload govuk-link" title="Go fullscreen"></a>\t\t\t<a href="#" tabindex="0" class="fullScreenOFF smooth noload govuk-link" title="Exit fullscreen"></a>\t\t</div>'),$(this).hasClass("audioPlayer")&&($(this).find(".fullScreen").remove(),$(this).find(".fullScreenOFF").remove()),function(playerGUI,mainPlayer,settings,extras){var supplied=new Array;$.each(settings.media,function(key,value){"poster"!=key&&supplied.push(key)}),formats=supplied.join(", ");var options={ready:function(){$(this).jPlayer("setMedia",settings.media),null!=settings.autoplay&&$(mainPlayer).jPlayer("play")},swfPath:"/projects/clean-jplayer-skin/jquery.jplayer.swf",supplied:formats,solution:"html, flash",volume:.5,size:settings.size,smoothPlayBar:!1,keyEnabled:!0,cssSelectorAncestor:playerGUI,cssSelector:{videoPlay:".video-play",play:".play",pause:".pause",seekBar:".seekBar",playBar:".playBar",volumeBar:".currentVolume",volumeBarValue:".currentVolume .curvol",currentTime:".time.current",duration:".time.duration",fullScreen:".fullScreen",restoreScreen:".fullScreenOFF",gui:".controls",noSolution:".noSolution"},error:function(event){event.jPlayer.error.type===$.jPlayer.error.URL_NOT_SET&&$(this).jPlayer("setMedia",settings.media).jPlayer("play")},play:function(){$(playerGUI+" .video-play").fadeOut(),$(this).on("click",function(){$(mainPlayer).jPlayer("pause")}),$(this).jPlayer("pauseOthers")},pause:function(){$(playerGUI+" .video-play").fadeIn(),$(playerGUI+" .playerScreen").unbind("click")},volumechange:function(event){event.jPlayer.options.muted?$(playerGUI+" .currentVolume").val(0):$(playerGUI+" .currentVolume").val(event.jPlayer.options.volume)},timeupdate:function(event){$(playerGUI+" .seekBar").val(event.jPlayer.status.currentPercentRelative)},progress:function(event){$(playerGUI+" .seekBar").val(event.jPlayer.status.currentPercentRelative)},ended:function(){$(this).jPlayer("setMedia",settings.media)}};$(playerGUI+" .currentVolume").slider({range:[0,1],step:.01,start:.5,handles:1,slide:function(){var value=$(this).val();$(mainPlayer).jPlayer("option","muted",!1),$(mainPlayer).jPlayer("option","volume",value),$(playerGUI+" .volumeText").html("Volume: "+(100*value).toFixed(0))}}),$(playerGUI+" .seekBar").slider({range:[0,100],step:.01,start:0,handles:1,slide:function(){var value=$(this).val();$(mainPlayer).jPlayer("playHead",value)}}),$.extend(options,extras),$(mainPlayer).jPlayer(options)}(playerGUI,playerID,settings,extras)}}(jQuery);